BiocManager::install("rtracklayer")
BiocManager::install("org.Hs.eg.db")
BiocManager::install("AnnotationDbi")
suppressPackageStartupMessages({
library(rtracklayer)
library(dplyr)
library(org.Hs.eg.db)
library(AnnotationDbi)
})
suppressPackageStartupMessages({
library(rtracklayer)
library(dplyr)
})
gene_out <- "../workflow/reference/gene_annotations_113.csv"
transcript_out <- "../reference/transcript_annotations_113.csv"
gtf_path <- "../reference/Homo_sapiens.GRCh38.113.gtf.gz"
gtf_data <- import(gtf_path)
gtf_data <- import(gtf_path)
# Transcript-level
transcript_annotations_df <- gtf_data[gtf_data$type == "transcript"] %>%
as.data.frame() %>%
select(seqnames, start, end, strand, gene_id,
transcript_id, gene_name, gene_biotype) %>%
mutate(length = end - start + 1)
# Transcript-level
transcript_annotations_df <- gtf_data[gtf_data$type == "transcript"] %>%
as.data.frame() %>%
dplyr::select(seqnames, start, end, strand, gene_id,
transcript_id, gene_name, gene_biotype) %>%
mutate(length = end - start + 1)
write.csv(transcript_annotations_df, transcript_out, row.names = FALSE)
# Gene-level
gene_annotations_df <- gtf_data[gtf_data$type == "gene"] %>%
as.data.frame() %>%
dplyr::select(seqnames, start, end, strand, gene_id,
gene_name, gene_biotype) %>%
mutate(length = end - start + 1)
write.csv(gene_annotations_df, gene_out, row.names = FALSE)
gene_out <- "../reference/gene_annotations_113.csv"
write.csv(gene_annotations_df, gene_out, row.names = FALSE)
suppressPackageStartupMessages({
library(rtracklayer)
library(dplyr)
library(org.Hs.eg.db)
library(AnnotationDbi)
})
# Import GTF
gtf_data <- import(gtf_path)
# Transcript-level
transcript_annotations <- gtf_data[gtf_data$type == "transcript"]
transcript_annotations_df <- as.data.frame(transcript_annotations) %>%
dplyr::select(seqnames, start, end, strand, gene_id, transcript_id, gene_name, gene_biotype) %>%
dplyr::mutate(length = end - start + 1)
write.csv(transcript_annotations_df, transcript_out, row.names = FALSE)
# Gene-level
gene_annotations <- gtf_data[gtf_data$type == "gene"]
gene_annotations_df <- as.data.frame(gene_annotations) %>%
dplyr::select(seqnames, start, end, strand, gene_id, gene_name, gene_biotype) %>%
dplyr::mutate(length = end - start + 1)
gene_annotations_df$entrez_id <- mapIds(
org.Hs.eg.db,
keys = gene_annotations_df$gene_id,
column = "ENTREZID",
keytype = "ENSEMBL",
multiVals = "first"
)
write.csv(gene_annotations_df, gene_out, row.names = FALSE)
